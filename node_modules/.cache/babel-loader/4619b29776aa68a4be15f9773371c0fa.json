{"ast":null,"code":"import _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from \"react\";\nimport { Form, Button, Message, Input, Table } from \"semantic-ui-react\";\nimport tracker from \"../../ethereum/tracker\";\nimport Layout from \"../../components/Layout\";\nimport web3 from \"../../ethereum/web3\";\nimport { Router } from \"../../routes\";\nimport AssetRow from \"../../components/AssetRow\";\n\nvar TransferForm =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TransferForm, _Component);\n\n  function TransferForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, TransferForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TransferForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      id: \"\",\n      value: \"\",\n      errorMessage: \"\",\n      loading: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSubmit\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var _this$state, id, value, accounts;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n\n                _this.setState({\n                  loading: true,\n                  errorMessage: \"\"\n                });\n\n                _this$state = _this.state, id = _this$state.id, value = _this$state.value;\n                _context.prev = 3;\n                _context.next = 6;\n                return web3.eth.getAccounts();\n\n              case 6:\n                accounts = _context.sent;\n                _context.next = 9;\n                return tracker.methods.transferProduct(id).send({\n                  from: accounts[0],\n                  value: web3.utils.toWei(_this.state.value, \"ether\"),\n                  gas: \"1000000\"\n                });\n\n              case 9:\n                console.log(\"DDDDD\", id);\n                _context.next = 15;\n                break;\n\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context[\"catch\"](3);\n\n                _this.setState({\n                  errorMessage: _context.t0.message\n                });\n\n              case 15:\n                _this.setState({\n                  loading: false,\n                  value: \"\"\n                });\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[3, 12]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    return _this;\n  }\n\n  _createClass(TransferForm, [{\n    key: \"renderRows\",\n    value: function renderRows() {\n      return this.props.assets.map(function (asset, index) {\n        return React.createElement(AssetRow, {\n          key: index,\n          id: index,\n          asset: asset //address={this.props.owner}\n\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var Header = Table.Header,\n          Row = Table.Row,\n          HeaderCell = Table.HeaderCell,\n          Body = Table.Body;\n      return React.createElement(Layout, null, React.createElement(Table, null, React.createElement(Header, null, React.createElement(Row, null, React.createElement(HeaderCell, null, \"ID\"), React.createElement(HeaderCell, null, \"Name\"), React.createElement(HeaderCell, null, \"Description\"), React.createElement(HeaderCell, null, \"Manufacturer\"), React.createElement(HeaderCell, null, \"Price\"), React.createElement(HeaderCell, null, \"Address of Owner\"))), React.createElement(Body, null, this.renderRows())), React.createElement(Form, {\n        onSubmit: this.onSubmit,\n        error: !!this.state.errorMessage\n      }, React.createElement(Form.Field, null, React.createElement(\"label\", null, \"ID\"), React.createElement(Input, {\n        value: this.state.id,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            id: event.target.value\n          });\n        }\n      })), React.createElement(Form.Field, null, React.createElement(\"label\", null, \"Amount to stake\"), React.createElement(Input, {\n        value: this.state.value,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            value: event.target.value\n          });\n        }\n      })), React.createElement(Message, {\n        error: true,\n        header: \"Oops!\",\n        content: this.state.errorMessage\n      }), React.createElement(Button, {\n        loading: this.state.loading,\n        primary: true\n      }, \"Confirm Purchase!\")));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(props) {\n        var assetCount, assets;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return tracker.methods.assetsCount().call();\n\n              case 2:\n                assetCount = _context2.sent;\n                _context2.next = 5;\n                return _Promise.all(Array(_parseInt(assetCount)).fill().map(function (element, index) {\n                  return tracker.methods.assets(index).call();\n                }));\n\n              case 5:\n                assets = _context2.sent;\n                return _context2.abrupt(\"return\", {\n                  assets: assets,\n                  assetCount: assetCount\n                });\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function getInitialProps(_x2) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return TransferForm;\n}(Component);\n\nexport default TransferForm;","map":null,"metadata":{},"sourceType":"module"}